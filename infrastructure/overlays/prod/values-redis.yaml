# gitops-platform/infrastructure/overlays/prod/values-redis.yaml
# Production config: Sentinel HA, persistence, TLS

architecture: replication  # ✅ Master + replicas

image:
  registry: docker.io
  repository: redis
  tag: 7-alpine
  pullPolicy: IfNotPresent

auth:
  enabled: true
  existingSecret: redis-credentials
  existingSecretPasswordKey: REDIS_PASSWORD

master:
  persistence:
    enabled: true
    size: 20Gi
    storageClass: "gp3"
  resources:
    requests:
      memory: 1Gi
      cpu: 500m
    limits:
      memory: 2Gi
      cpu: 1000m

replica:
  replicaCount: 2  # ✅ 2 read replicas
  persistence:
    enabled: true
    size: 20Gi
  resources:
    requests:
      memory: 512Mi
      cpu: 250m
    limits:
      memory: 1Gi
      cpu: 500m

sentinel:
  enabled: true  # ✅ Automatic failover
  replicaCount: 3
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 512Mi
      cpu: 250m

# ✅ Production: enable TLS
tls:
  enabled: true
  autoGenerated: false
  existingSecret: "redis-tls-cert"

# ✅ Monitoring
metrics:
  enabled: true
  serviceMonitor:
    enabled: true

# ✅ Security hardening
config:
  maxmemory: "1500mb"
  maxmemory-policy: "allkeys-lru"
  protected-mode: "yes"